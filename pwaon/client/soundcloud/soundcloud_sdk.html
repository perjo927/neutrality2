<template name="soundcloud_sdk">
    <script>
        var that = this;

        // TODO: Authentication works in prod, not in localhost
        Meteor.call("parseAssets", "clientId", function (err,res) {
            if(!!err) {
                //
            } else {
                var clientId = res;
                var rootUrl = Meteor.absoluteUrl();
                var redirectUri = rootUrl + "callback";

                // initialize client with app credentials
                that.SC.initialize({
                    client_id: clientId,
                    redirect_uri: redirectUri
                });

                // initiate auth popup
                that.SC.connect(function() {
                    that.SC.get('/me', function(me) {
                        console.log('Hello, ', me);
                    });
                });

                // update user's profile description
                that.SC.connect(function() {
                    SC.put('/me', {
                                user: {description: 'I am using the SoundCloud API!'}
                    });
                });
            }
        });
    </script>
</template>